rule suspicious_packer
{
    meta:
        author = "CyberThreatAI"
        description = "Detects common packers used to obfuscate malware"
        severity = "high"
        category = "malware"

    strings:
        $upx = "UPX!" ascii
        $aspack = "aPlib" ascii
        $mpress = "MPRESS" ascii
        $themida = ".themida" ascii

    condition:
        uint16(0) == 0x5A4D and any of them
}

rule suspicious_strings
{
    meta:
        author = "CyberThreatAI"
        description = "Detects suspicious strings commonly found in malware"
        severity = "medium"
        category = "malware"

    strings:
        $s1 = "cmd.exe" ascii nocase
        $s2 = "powershell" ascii nocase
        $s3 = "WScript.Shell" ascii nocase
        $s4 = "ShellExecute" ascii nocase
        $s5 = "CreateRemoteThread" ascii
        $s6 = "VirtualAllocEx" ascii
        $s7 = "WriteProcessMemory" ascii

    condition:
        uint16(0) == 0x5A4D and 3 of them
}
